# auto_quoter

–ù–µ–±–æ–ª—å—à–∞—è —É—Ç–∏–ª–∏—Ç–∞ –Ω–∞ Python, –∫–æ—Ç–æ—Ä–∞—è:

1. –ü–∞—Ä—Å–∏—Ç —Å–ª—É—á–∞–π–Ω—É—é —Ü–∏—Ç–∞—Ç—É —Å `https://citaty.info/random` (–∏–ª–∏ –ª—é–±–æ–≥–æ –¥—Ä—É–≥–æ–≥–æ —Å–∞–π—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –≤—ã —É–∫–∞–∂–µ—Ç–µ).
2. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ—ë –≤ –≤–∞—à GitHub‚Äë—Å—Ç–∞—Ç—É—Å —á–µ—Ä–µ–∑ GraphQL API –≤ —Ñ–æ—Ä–º–∞—Ç–µ `"<—Ü–∏—Ç–∞—Ç–∞>" ‚Äî <–∏—Å—Ç–æ—á–Ω–∏–∫>`.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.12+
- –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π GitHub‚Äë—Ç–æ–∫–µ–Ω —Å –ø—Ä–∞–≤–æ–º `user` (–Ω—É–∂–µ–Ω –¥–ª—è `changeUserStatus`).

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
python3 -m venv .venv
.venv/bin/python -m pip install --upgrade pip
.venv/bin/pip install -r requirements.txt
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`config.json`)

```json
{
	"parser": {
		"url": "https://citaty.info/random",
		"quote_selector": "div.field-name-body a > p",
		"source_selector": "a.copy-to-clipboard",
		"source_attr": "data-source",
		"block_selector": "article.node-quote",
		"max_attempts": 0,
		"retry_interval_seconds": 1.0
	},
	"timeout": 10,
	"loop": true,
	"refresh_interval_seconds": 3600,
	"debug": false,
	"github": {
		"enabled": true,
		"token": "",
		"emoji": ":speech_balloon:",
		"graphql_url": "https://api.github.com/graphql",
		"max_status_length": 80,
		"dry_run": true
	}
}
```

- `parser.*` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CSS‚Äë—Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ –∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ü–∏—Ç–∞—Ç. `block_selector` –∑–∞–¥–∞—ë—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–∞–∂–¥–æ–π —Ü–∏—Ç–∞—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `article.node-quote` –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö `/random` –∏ `/short`); –≤–Ω—É—Ç—Ä–∏ –±–ª–æ–∫–∞ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è `quote_selector` –∏ `source_selector`.
- `parser.max_attempts` ‚Äî —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É, –ø–æ–∫–∞ –Ω–µ –Ω–∞–π–¥—ë–º —Ü–∏—Ç–∞—Ç—É, –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–º–µ—â–∞—é—â—É—é—Å—è –≤ –ª–∏–º–∏—Ç —Å—Ç–∞—Ç—É—Å–∞. `0` –æ–∑–Ω–∞—á–∞–µ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ (–ø–æ –æ–¥–Ω–æ–π –≤ —Å–µ–∫—É–Ω–¥—É) –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ —É—Å–ª–æ–≤–∏–µ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è.
- `parser.retry_interval_seconds` ‚Äî –ø–∞—É–∑–∞ –º–µ–∂–¥—É –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏.
- `github.enabled` ‚Äî –≤–∫–ª—é—á–∞–µ—Ç/–≤—ã–∫–ª—é—á–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É —Å—Ç–∞—Ç—É—Å–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥—Ä—É–≥–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫.
- `github.token` ‚Äî –ø–æ–ª–µ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º –∏ –∑–∞–¥–∞—Ç—å —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ `.env` (–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `AUTO_QUOTER_GITHUB_TOKEN`, –æ–±—Ä–∞–∑–µ—Ü –≤ `.env.example`). –ö–æ–Ω—Ñ–∏–≥ –ø–æ‚Äë–ø—Ä–µ–∂–Ω–µ–º—É –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø—Ä—è–º–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞, –µ—Å–ª–∏ –≤–∞–º —Ç–∞–∫ —É–¥–æ–±–Ω–µ–µ.
- `github.emoji` ‚Äî —ç–º–æ–¥–∑–∏ —Ä—è–¥–æ–º —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).
- `github.graphql_url` ‚Äî –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Ç–æ—á–∫–∞ GraphQL (–æ–±—ã—á–Ω–æ –Ω–µ –Ω—É–∂–Ω–∞).
- `loop` ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç –ª–∏ —Å–∫—Ä–∏–ø—Ç –≤ —Ü–∏–∫–ª–µ. –ï—Å–ª–∏ `false`, –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –æ–¥–∏–Ω –ø—Ä–æ—Ö–æ–¥.
- `refresh_interval_seconds` ‚Äî –æ–±—â–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö) –º–µ–∂–¥—É —Ü–∏–∫–ª–∞–º–∏; –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –∏ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Å—Ç–∞—Ç—É—Å–∞ –≤ GitHub. –ï—Å–ª–∏ `<= 0`, —Å–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑.
- `debug` ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Ñ–ª–∞–≥ –æ—Ç–ª–∞–¥–∫–∏; –≤–∫–ª—é—á–∞–µ—Ç –ø–µ—á–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –ª–æ–≥–æ–≤ –¥–ª—è GitHub –∏ –æ—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–∏.
- `github.max_status_length` ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 80 —Å–∏–º–≤–æ–ª–æ–≤, –∫–∞–∫ –Ω–∞ GitHub). –°–∫—Ä–∏–ø—Ç —Å–Ω–∞—á–∞–ª–∞ –∏—â–µ—Ç —Ü–∏—Ç–∞—Ç—É, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ –ª–∏–º–∏—Ç, –∏ –ª–∏—à—å –∑–∞—Ç–µ–º –ø—Ä–∏–±–µ–≥–∞–µ—Ç –∫ –æ–±—Ä–µ–∑–∞–Ω–∏—é.
- `github.dry_run` ‚Äî –ø—Ä–∏ `true` –≤—ã–≤–æ–¥–∏—Ç —Ç–µ–ª–æ GraphQL‚Äë–º—É—Ç–∞—Ü–∏–∏ –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.

> üí° –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` –∏ –∑–∞–¥–∞–π—Ç–µ `AUTO_QUOTER_GITHUB_TOKEN=...`. –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞—é—Ç —Ñ–∞–π–ª –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω–æ, —Ç–∞–∫ –∏ –≤–Ω—É—Ç—Ä–∏ GitHub Actions (workflow —Å–æ–∑–¥–∞—ë—Ç `.env` –Ω–∞ –ª–µ—Ç—É –∏–∑ —Å–µ–∫—Ä–µ—Ç–æ–≤).

## **GitHub Environment Setup (via website)**

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–µ–∫—Ä–µ—Ç–∞–º–∏ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —á–µ—Ä–µ–∑ –≤–µ–±‚Äë–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å GitHub, —Å–æ–∑–¥–∞–π—Ç–µ Environment –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ –Ω–µ–≥–æ —Å–µ–∫—Ä–µ—Ç—ã:

- –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ github.com ‚Üí `Settings` ‚Üí `Environments` ‚Üí `New environment`.
- –í–≤–µ–¥–∏—Ç–µ –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `auto-quoter`) –∏ –Ω–∞–∂–º–∏—Ç–µ `Configure environment`.
- –í –ª–µ–≤–æ–π –∫–æ–ª–æ–Ω–∫–µ –≤—ã–±–µ—Ä–∏—Ç–µ `Secrets` ‚Üí `Actions` ‚Üí `New secret`.
	- –í –ø–æ–ª–µ `Name` —É–∫–∞–∂–∏—Ç–µ `AUTO_QUOTER_GITHUB_TOKEN`.
	- –í –ø–æ–ª–µ `Value` –≤—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω (PAT) —Å –ø—Ä–∞–≤–∞–º–∏ `user`.
	- –ù–∞–∂–º–∏—Ç–µ `Add secret`.
- (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –≤ `Variables` ‚Üí `Actions` –¥–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `RUN_INTERVAL_MINUTES` (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ –º–∏–Ω—É—Ç) –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º –º–µ–∂–¥—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ workflow.

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è Environment —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ workflow —É–∫–∞–∑–∞–Ω–æ –µ–≥–æ –∏–º—è –≤ `environment:`, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```yaml
jobs:
	run-auto-quoter:
		environment: auto-quoter
```

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ä–µ—Ç –∫–∞–∫ repository secret ‚Äî `Settings` ‚Üí `Secrets and variables` ‚Üí `Actions` ‚Üí `New repository secret` ‚Äî –∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Ç–æ –∂–µ `AUTO_QUOTER_GITHUB_TOKEN`.

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–µ workflow –≤—Ä—É—á–Ω—É—é (Actions ‚Üí Auto Quoter Runner ‚Üí Run workflow) –∏–ª–∏ –¥–æ–∂–¥–∏—Ç–µ—Å—å cron‚Äë–∑–∞–ø—É—Å–∫–∞.


–°—Ç–∞—Ç—É—Å –≤ GitHub –ø–æ–ª—É—á–∞–µ—Ç —Å—Ä–æ–∫ –∂–∏–∑–Ω–∏, —Ä–∞–≤–Ω—ã–π `refresh_interval_seconds`. –ü–æ–∫–∞ —Å–∫—Ä–∏–ø—Ç –∞–∫—Ç–∏–≤–µ–Ω –∏ `loop` –≤–∫–ª—é—á—ë–Ω, –æ–Ω –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å —Ü–∏—Ç–∞—Ç—É –ø–µ—Ä–µ–¥ –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º —Å—Ç–∞—Ç—É—Å–∞.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–û–¥–Ω–æ–∫—Ä–∞—Ç–Ω—ã–π –∑–∞–ø—É—Å–∫ –ª–∏–±–æ —Ñ–æ–Ω–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞ (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç `refresh_interval_seconds`):

```bash
./scripts/run.sh
```

–ü–æ–¥–±–æ—Ä CSS‚Äë—Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ (–∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–¥–∏–Ω —Ä–∞–∑ –∏ –≤—ã–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤):

```bash
python src/parser/selectors_tool.py
```

## –¢–µ—Å—Ç—ã

```bash
./scripts/test.sh
```

–Æ–Ω–∏—Ç‚Äë—Ç–µ—Å—Ç—ã –ø–æ–¥–º–µ–Ω—è—é—Ç —Å–µ—Ç–µ–≤—ã–µ –≤—ã–∑–æ–≤—ã (–∏ –ø–∞—Ä—Å–µ—Ä, –∏ GitHub‚Äë–∫–ª–∏–µ–Ω—Ç), –ø–æ—ç—Ç–æ–º—É –∏—Ö –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –æ—Ñ–ª–∞–π–Ω.